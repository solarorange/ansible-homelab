# üöÄ Quick Start Guide - Turnkey Deployment

This guide will get your Ansible Homelab up and running in under 30 minutes with minimal technical knowledge required.

## üìã **Prerequisites Checklist**

Before starting, ensure you have:

- [ ] **Server**: Ubuntu 20.04+ / Debian 11+ / CentOS 8+ with root access
- [ ] **Hardware**: 8GB+ RAM, 100GB+ storage, 4+ CPU cores
- [ ] **Network**: Static IP address configured
- [ ] **Domain**: A domain name with DNS access (Cloudflare recommended)
- [ ] **SSH Access**: SSH key or password access to your server

## üéØ **Step 1: Server Preparation (5 minutes)**

### 1.1 Update Your Server
```bash
# Connect to your server via SSH
ssh root@your-server-ip

# Update system packages
apt update && apt upgrade -y

# Install essential packages
apt install -y curl wget git python3 python3-pip software-properties-common
```

### 1.2 Install Ansible
```bash
# Add Ansible repository
apt-add-repository --yes --update ppa:ansible/ansible

# Install Ansible
apt install -y ansible

# Verify installation
ansible --version
```

### 1.3 Install Docker
```bash
# Install Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sh get-docker.sh

# Add your user to docker group
usermod -aG docker $USER

# Start and enable Docker
systemctl start docker
systemctl enable docker

# Verify Docker installation
docker --version
```

## üéØ **Step 2: Project Setup (5 minutes)**

### 2.1 Clone the Repository
```bash
# Clone the project
git clone https://github.com/solarorange/ansible-homelab.git
cd ansible_homelab

# Make scripts executable
chmod +x scripts/*.sh
```

### 2.2 Run the Interactive Setup
```bash
# Run the automated setup script
./scripts/setup_environment.sh
```

This script will:
- ‚úÖ Generate secure passwords for all services
- ‚úÖ Configure your domain and network settings
- ‚úÖ Set up API keys and credentials
- ‚úÖ Create all necessary directories
- ‚úÖ Configure environment variables

### 2.3 Review Configuration
```bash
# View your configuration
cat .env

# Edit if needed
nano .env
```

## üéØ **Step 3: Domain & DNS Setup (5 minutes)**

### 3.1 Configure Your Domain
1. **Go to your DNS provider** (Cloudflare recommended)
2. **Add these DNS records**:
   ```
   Type: A     Name: @           Value: YOUR_SERVER_IP
   Type: A     Name: traefik      Value: YOUR_SERVER_IP
   Type: A     Name: auth         Value: YOUR_SERVER_IP
   Type: A     Name: grafana      Value: YOUR_SERVER_IP
   Type: A     Name: sonarr       Value: YOUR_SERVER_IP
   Type: A     Name: radarr       Value: YOUR_SERVER_IP
   Type: A     Name: jellyfin     Value: YOUR_SERVER_IP
   Type: A     Name: overseerr    Value: YOUR_SERVER_IP
   Type: A     NameL homepage     Value: YOUR_SERVER_IP   
   ```

### 3.2 Cloudflare Setup (Recommended)
1. **Add your domain to Cloudflare**
2. **Get your API token**:
   - Go to Cloudflare Dashboard ‚Üí My Profile ‚Üí API Tokens
   - Create Custom Token with these permissions:
     - Zone:Zone:Read
     - Zone:DNS:Edit
     - Zone:Zone Settings:Edit
3. **Update your .env file**:
   ```bash
   nano .env
   # Add your Cloudflare API token and email
   ```

## üéØ **Step 4: Vault Configuration (5 minutes)**

### 4.1 Create Vault File
```bash
# Create encrypted vault file
ansible-vault create group_vars/all/vault.yml
```

### 4.2 Add Your Secrets
Copy and paste this template, replacing with your actual values:

```yaml
# Database Passwords (auto-generated by setup script)
vault_postgresql_password: "{{ lookup('env', 'POSTGRESQL_PASSWORD') }}"
vault_redis_password: "{{ lookup('env', 'REDIS_PASSWORD') }}"

# Service Admin Passwords (auto-generated by setup script)
vault_grafana_admin_password: "{{ lookup('env', 'GRAFANA_ADMIN_PASSWORD') }}"
vault_authentik_admin_password: "{{ lookup('env', 'AUTHENTIK_ADMIN_PASSWORD') }}"

# Cloudflare Configuration
vault_cloudflare_api_token: "{{ lookup('env', 'CLOUDFLARE_API_TOKEN') }}"
vault_cloudflare_email: "{{ lookup('env', 'CLOUDFLARE_EMAIL') }}"

# Optional: Traefik Pilot Token
vault_traefik_pilot_token: "{{ lookup('env', 'TRAEFIK_PILOT_TOKEN', default='') }}"

# Optional: SMTP Configuration
vault_smtp_username: "{{ lookup('env', 'SMTP_USERNAME', default='') }}"
vault_smtp_password: "{{ lookup('env', 'SMTP_PASSWORD', default='') }}"
```

## üéØ **Step 5: Deploy Infrastructure (10 minutes)**

### 5.1 Pre-flight Check
```bash
# Test your configuration
ansible-playbook site.yml --check --ask-vault-pass
```

### 5.2 Deploy Everything
```bash
# Deploy the complete infrastructure
ansible-playbook site.yml --ask-vault-pass
```

**What happens during deployment:**
1. üîí **Security Setup** - Firewall, SSH hardening, security tools
2. üê≥ **Docker Setup** - Docker installation and configuration
3. üåê **Network Setup** - Docker networks and routing
4. üîê **Authentication** - Authentik identity provider
5. üìä **Monitoring** - Prometheus, Grafana, Loki
6. üóÑÔ∏è **Databases** - PostgreSQL, Redis
7. üì∫ **Media Services** - Sonarr, Radarr, Jellyfin
8. üîß **Utilities** - Portainer, Homepage
9. ‚úÖ **Validation** - Health checks and testing

### 5.3 Monitor Deployment
```bash
# Watch the deployment progress
tail -f /opt/logs/ansible.log

# Check service status
docker ps
```

## üéØ **Step 6: Post-Deployment Setup (5 minutes)**

### 6.1 Access Your Services
Once deployment completes, access your services:

| Service | URL | Default Credentials |
|---------|-----|-------------------|
| **Authentik** | https://auth.your-domain.com | admin / (from vault) |
| **Grafana** | https://grafana.your-domain.com | admin / (from vault) |
| **Portainer** | https://portainer.your-domain.com | (create during setup) |
| **Sonarr** | https://sonarr.your-domain.com | (no auth by default) |
| **Radarr** | https://radarr.your-domain.com | (no auth by default) |
| **Jellyfin** | https://jellyfin.your-domain.com | (create during setup) |

### 6.2 Initial Configuration

#### Authentik Setup
1. **Access Authentik**: https://auth.your-domain.com
2. **Login**: admin / (password from vault)
3. **Applications Ready**: All services are pre-configured and available in the dashboard
4. **Optional**: Add additional users and groups as needed

#### Grafana Setup
1. **Access Grafana**: https://grafana.your-domain.com
2. **Login**: admin / (password from vault)
3. **Add Data Sources**:
   - Prometheus: http://prometheus:9090
   - Loki: http://loki:3100

#### Media Services Setup
1. **Configure Sonarr**: Add download clients and indexers
2. **Configure Radarr**: Add download clients and indexers
3. **Configure Jellyfin**: Add media libraries

## üéØ **Step 7: Validation & Testing**

### 7.1 Run Health Checks
```bash
# Validate all services
ansible-playbook tasks/validate_services.yml --ask-vault-pass

# Run integration tests
ansible-playbook tests/integration/test_services.yml --ask-vault-pass
```

### 7.2 Check System Health
```bash
# View system status
docker ps -a

# Check logs
docker logs traefik
docker logs authentik
docker logs grafana

# Monitor resources
htop
df -h
```

## üîß **Troubleshooting Common Issues**

### Issue: Services Won't Start
```bash
# Check Docker status
systemctl status docker

# Check service logs
docker logs <service-name>

# Restart Docker
systemctl restart docker
```

### Issue: Domain Not Accessible
```bash
# Check DNS propagation
nslookup your-domain.com

# Check firewall
ufw status

# Check Traefik logs
docker logs traefik
```

### Issue: SSL Certificate Problems
```bash
# Check Cloudflare settings
# Ensure SSL/TLS is set to "Full" or "Full (strict)"

# Check Traefik certificate logs
docker logs traefik | grep -i cert
```

### Issue: Database Connection Errors
```bash
# Check database status
docker ps | grep postgres
docker ps | grep redis

# Check database logs
docker logs postgresql
docker logs redis
```

## üìä **Monitoring Your Homelab**

### Access Monitoring Dashboards
- **Grafana**: https://grafana.your-domain.com
- **Prometheus**: https://prometheus.your-domain.com
- **Traefik**: https://traefik.your-domain.com

### Key Metrics to Monitor
- **System Resources**: CPU, Memory, Disk Usage
- **Service Health**: All services should show "healthy"
- **Network Traffic**: Incoming requests and bandwidth
- **Error Rates**: Check for any service errors

## üîÑ **Maintenance & Updates**

### Regular Maintenance
```bash
# Update all services
ansible-playbook tasks/update_services.yml --ask-vault-pass

# Backup all data
ansible-playbook tasks/backup.yml --ask-vault-pass

# Check system health
ansible-playbook tasks/health_check.yml --ask-vault-pass
```

### System Updates
```bash
# Update system packages
apt update && apt upgrade -y

# Update Docker images
docker-compose pull
docker-compose up -d
```

## üÜò **Getting Help**

### Documentation
- **Main README**: [README.md](README.md)
- **Architecture**: [docs/ARCHITECTURE.md](docs/ARCHITECTURE.md)
- **Troubleshooting**: [TROUBLESHOOTING.md](TROUBLESHOOTING.md)

### Support Channels
- **GitHub Issues**: Report bugs and request features
- **GitHub Discussions**: Ask questions and share experiences
- **Documentation**: Comprehensive guides and tutorials

### Common Commands Reference
```bash
# View all services
docker ps

# View service logs
docker logs <service-name>

# Restart a service
docker restart <service-name>

# Update a specific service
docker-compose -f /opt/docker/<service>/docker-compose.yml pull
docker-compose -f /opt/docker/<service>/docker-compose.yml up -d

# Check system resources
htop
df -h
free -h

# View firewall status
ufw status
```

## üéâ **Congratulations!**

Your Ansible Homelab is now fully deployed and ready to use! You have:

- ‚úÖ **Secure Infrastructure** with authentication and monitoring
- ‚úÖ **Media Services** for TV shows, movies, and music
- ‚úÖ **Monitoring Stack** for system health and performance
- ‚úÖ **Backup System** for data protection
- ‚úÖ **Automated Maintenance** for ongoing operations

**Next Steps:**
1. **Configure your media services** (Sonarr, Radarr, Jellyfin)
2. **Set up your media libraries** and download clients
3. **Customize your dashboards** in Grafana
4. **Explore additional services** as needed
5. **Join the community** for support and updates

---

**Need help?** Check the [Troubleshooting Guide](TROUBLESHOOTING.md) or create an issue on GitHub! 