# CodeRabbit Configuration for Ansible Homelab
# Focus: Functionality, reliability, and production readiness

# Global settings
global:
  # Focus on code quality and functionality over new features
  focus: "functionality,reliability,production-readiness"
  
  # Language-specific settings
  languages:
    yaml:
      # Ansible-specific linting and validation
      linting: true
      formatting: true
      security: true
    python:
      linting: true
      formatting: true
      security: true
    shell:
      linting: true
      security: true
    markdown:
      formatting: true

# Review settings
review:
  # Focus on critical issues that affect functionality
  priority: "critical,high"
  
  # Review scope - focus on core functionality
  scope:
    - "ansible playbooks and roles"
    - "docker compose templates"
    - "security configurations"
    - "automation scripts"
    - "deployment workflows"
  
  # Exclude non-functional changes
  exclude:
    - "documentation only changes"
    - "cosmetic formatting"
    - "test files"
    - "backup files"
    - "log files"

# Ansible-specific rules
ansible:
  # Validate playbook syntax and structure
  syntax_check: true
  
  # Check for common Ansible best practices
  best_practices: true
  
  # Validate variable usage and vault integration
  variable_validation: true
  
  # Check for security issues
  security_scan: true

# Docker-specific rules
docker:
  # Validate compose file syntax
  compose_validation: true
  
  # Check for security best practices
  security_scan: true
  
  # Validate environment variable usage
  env_validation: true

# Security focus
security:
  # Scan for hardcoded secrets
  secret_detection: true
  
  # Check for privilege escalation issues
  privilege_escalation: true
  
  # Validate SSL/TLS configurations
  ssl_validation: true
  
  # Check firewall and network security
  network_security: true

# Performance and reliability
reliability:
  # Check for resource usage optimization
  resource_optimization: true
  
  # Validate error handling
  error_handling: true
  
  # Check for proper logging
  logging_validation: true
  
  # Validate backup and recovery procedures
  backup_validation: true

# Comment templates
comments:
  # Focus on actionable feedback
  style: "constructive,actionable"
  
  # Include code examples when helpful
  include_examples: true
  
  # Suggest specific improvements
  suggest_improvements: true
  
  # Link to relevant documentation
  include_documentation: true

# File patterns to focus on
files:
  include:
    - "**/*.yml"
    - "**/*.yaml"
    - "**/*.py"
    - "**/*.sh"
    - "**/docker-compose*.yml"
    - "**/main.yml"
    - "**/site.yml"
    - "**/roles/**/*.yml"
    - "**/tasks/**/*.yml"
    - "**/handlers/**/*.yml"
    - "**/templates/**/*.j2"
  
  exclude:
    - "**/*.log"
    - "**/*.backup"
    - "**/backups/**"
    - "**/logs/**"
    - "**/.git/**"
    - "**/node_modules/**"
    - "**/__pycache__/**"
    - "**/*.pyc"
    - "**/*.pyo"
    - "**/*.pyd"
    - "**/.DS_Store"
    - "**/Thumbs.db"
