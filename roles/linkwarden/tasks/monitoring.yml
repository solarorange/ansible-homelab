---
# Linkwarden Monitoring Configuration
# Configures monitoring integration for Linkwarden

- name: Configure Prometheus monitoring for Linkwarden
  ansible.builtin.template:
    src: prometheus.yml.j2
    dest: "{{ prometheus_config_dir }}/linkwarden.yml"
    owner: "{{ username }}"
    group: "{{ username }}"
    mode: "0644"
  when: linkwarden_prometheus_enabled | default(true)
  tags: [linkwarden, monitoring]

- name: Configure Grafana dashboard for Linkwarden
  ansible.builtin.template:
    src: grafana-dashboard.json.j2
    dest: "{{ grafana_dashboards_dir }}/linkwarden.json"
    owner: "{{ username }}"
    group: "{{ username }}"
    mode: "0644"
  when: linkwarden_grafana_enabled | default(true)
  tags: [linkwarden, monitoring]

- name: Configure Loki logging for Linkwarden
  ansible.builtin.template:
    src: loki-config.yml.j2
    dest: "{{ loki_config_dir }}/linkwarden.yml"
    owner: "{{ username }}"
    group: "{{ username }}"
    mode: "0644"
  when: linkwarden_loki_enabled | default(true)
  tags: [linkwarden, monitoring] 