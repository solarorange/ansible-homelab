# Logrotate configuration for Immich
# Generated by Ansible - DO NOT EDIT MANUALLY

{{ logs_dir }}/immich/*/*.log {
    daily
    missingok
    rotate {{ immich_log_retention | default(30) }}
    compress
    delaycompress
    notifempty
    create 644 {{ ansible_user }} {{ ansible_user }}
    postrotate
        systemctl reload immich-monitoring > /dev/null 2>&1 || true
    endscript
}

{{ logs_dir }}/immich/backup/*.log {
    daily
    missingok
    rotate {{ immich_backup_retention_days | default(7) }}
    compress
    delaycompress
    notifempty
    create 644 {{ ansible_user }} {{ ansible_user }}
}

{{ logs_dir }}/immich/health/*.log {
    daily
    missingok
    rotate {{ immich_health_check_retention_days | default(7) }}
    compress
    delaycompress
    notifempty
    create 644 {{ ansible_user }} {{ ansible_user }}
} 