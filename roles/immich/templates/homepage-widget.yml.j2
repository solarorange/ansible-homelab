# Homepage widget configuration for Immich
# Generated by Ansible - DO NOT EDIT MANUALLY

widgets:
  - name: "Immich Status"
    type: "api"
    url: "https://immich.{{ domain }}/api/health"
    method: "GET"
    headers:
      Accept: "application/json"
    refresh: 30
    position:
      x: 0
      y: 0
      w: 6
      h: 4
    style:
      background: "rgba(0, 0, 0, 0.1)"
      border: "1px solid rgba(255, 255, 255, 0.1)"
      borderRadius: "8px"
      padding: "16px"
    data:
      status: "{{ '{{' }} response.status {{ '}}' }}"
      uptime: "{{ '{{' }} response.uptime {{ '}}' }}"
      version: "{{ '{{' }} response.version {{ '}}' }}"
    template: |
      <div style="text-align: center;">
        <h3 style="margin: 0 0 8px 0; color: #fff;">Immich Status</h3>
        <div style="font-size: 24px; margin: 8px 0;">
          {{ '{{' }} if data.status === 'ok' {{ '}}' }}
            <span style="color: #4ade80;">●</span>
          {{ '{{' }} else {{ '}}' }}
            <span style="color: #ef4444;">●</span>
          {{ '{{' }} endif {{ '}}' }}
        </div>
        <div style="font-size: 12px; color: #9ca3af;">
          {{ '{{' }} data.status | title {{ '}}' }}
        </div>
        {{ '{{' }} if data.uptime {{ '}}' }}
        <div style="font-size: 10px; color: #6b7280; margin-top: 4px;">
          Uptime: {{ '{{' }} data.uptime {{ '}}' }}
        </div>
        {{ '{{' }} endif {{ '}}' }}
      </div>

  - name: "Immich Stats"
    type: "api"
    url: "https://immich.{{ domain }}/api/server-info"
    method: "GET"
    headers:
      Accept: "application/json"
    refresh: 60
    position:
      x: 6
      y: 0
      w: 6
      h: 4
    style:
      background: "rgba(0, 0, 0, 0.1)"
      border: "1px solid rgba(255, 255, 255, 0.1)"
      borderRadius: "8px"
      padding: "16px"
    data:
      photos: "{{ '{{' }} response.photos {{ '}}' }}"
      videos: "{{ '{{' }} response.videos {{ '}}' }}"
      users: "{{ '{{' }} response.users {{ '}}' }}"
      storage: "{{ '{{' }} response.storage {{ '}}' }}"
    template: |
      <div style="text-align: center;">
        <h3 style="margin: 0 0 8px 0; color: #fff;">Immich Stats</h3>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 12px;">
          <div>
            <div style="color: #9ca3af;">Photos</div>
            <div style="color: #fff; font-weight: bold;">{{ '{{' }} data.photos | default(0) | number {{ '}}' }}</div>
          </div>
          <div>
            <div style="color: #9ca3af;">Videos</div>
            <div style="color: #fff; font-weight: bold;">{{ '{{' }} data.videos | default(0) | number {{ '}}' }}</div>
          </div>
          <div>
            <div style="color: #9ca3af;">Users</div>
            <div style="color: #fff; font-weight: bold;">{{ '{{' }} data.users | default(0) | number {{ '}}' }}</div>
          </div>
          <div>
            <div style="color: #9ca3af;">Storage</div>
            <div style="color: #fff; font-weight: bold;">{{ '{{' }} data.storage | default('0 B') {{ '}}' }}</div>
          </div>
        </div>
      </div>

  - name: "Immich Recent Activity"
    type: "api"
    url: "https://immich.{{ domain }}/api/activity"
    method: "GET"
    headers:
      Accept: "application/json"
    refresh: 120
    position:
      x: 0
      y: 4
      w: 12
      h: 6
    style:
      background: "rgba(0, 0, 0, 0.1)"
      border: "1px solid rgba(255, 255, 255, 0.1)"
      borderRadius: "8px"
      padding: "16px"
    data:
      activities: "{{ '{{' }} response.activities | slice(0, 10) {{ '}}' }}"
    template: |
      <div>
        <h3 style="margin: 0 0 12px 0; color: #fff;">Recent Activity</h3>
        {{ '{{' }} if data.activities && data.activities.length > 0 {{ '}}' }}
          <div style="max-height: 200px; overflow-y: auto;">
            {{ '{{' }} for activity in data.activities {{ '}}' }}
              <div style="display: flex; justify-content: space-between; align-items: center; padding: 4px 0; border-bottom: 1px solid rgba(255, 255, 255, 0.1);">
                <div style="flex: 1;">
                  <div style="color: #fff; font-size: 12px;">{{ '{{' }} activity.type | title {{ '}}' }}</div>
                  {{ '{{' }} if activity.user {{ '}}' }}
                  <div style="color: #9ca3af; font-size: 10px;">{{ '{{' }} activity.user.firstName {{ '}}' }} {{ '{{' }} activity.user.lastName {{ '}}' }}</div>
                  {{ '{{' }} endif {{ '}}' }}
                </div>
                <div style="color: #6b7280; font-size: 10px; text-align: right;">
                  {{ '{{' }} activity.createdAt | timeago {{ '}}' }}
                </div>
              </div>
            {{ '{{' }} endfor {{ '}}' }}
          </div>
        {{ '{{' }} else {{ '}}' }}
          <div style="text-align: center; color: #9ca3af; font-size: 12px; padding: 20px;">
            No recent activity
          </div>
        {{ '{{' }} endif {{ '}}' }}
      </div>

  - name: "Immich System Info"
    type: "api"
    url: "https://immich.{{ domain }}/api/system-info"
    method: "GET"
    headers:
      Accept: "application/json"
    refresh: 300
    position:
      x: 0
      y: 10
      w: 12
      h: 4
    style:
      background: "rgba(0, 0, 0, 0.1)"
      border: "1px solid rgba(255, 255, 255, 0.1)"
      borderRadius: "8px"
      padding: "16px"
    data:
      version: "{{ '{{' }} response.version {{ '}}' }}"
      build: "{{ '{{' }} response.build {{ '}}' }}"
      environment: "{{ '{{' }} response.environment {{ '}}' }}"
      database: "{{ '{{' }} response.database {{ '}}' }}"
      redis: "{{ '{{' }} response.redis {{ '}}' }}"
    template: |
      <div>
        <h3 style="margin: 0 0 12px 0; color: #fff;">System Information</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px; font-size: 12px;">
          <div>
            <div style="color: #9ca3af;">Version</div>
            <div style="color: #fff;">{{ '{{' }} data.version | default('Unknown') {{ '}}' }}</div>
          </div>
          <div>
            <div style="color: #9ca3af;">Build</div>
            <div style="color: #fff;">{{ '{{' }} data.build | default('Unknown') {{ '}}' }}</div>
          </div>
          <div>
            <div style="color: #9ca3af;">Environment</div>
            <div style="color: #fff;">{{ '{{' }} data.environment | default('Unknown') {{ '}}' }}</div>
          </div>
          <div>
            <div style="color: #9ca3af;">Database</div>
            <div style="color: #fff;">{{ '{{' }} data.database | default('Unknown') {{ '}}' }}</div>
          </div>
          <div>
            <div style="color: #9ca3af;">Redis</div>
            <div style="color: #fff;">{{ '{{' }} data.redis | default('Unknown') {{ '}}' }}</div>
          </div>
        </div>
      </div>

# Custom CSS for Immich widgets
custom_css: |
  .immich-widget {
    transition: all 0.3s ease;
  }
  
  .immich-widget:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
  }
  
  .immich-status-indicator {
    display: inline-block;
    width: 12px;
    height: 12px;
    border-radius: 50%;
    margin-right: 8px;
  }
  
  .immich-status-ok {
    background-color: #4ade80;
  }
  
  .immich-status-error {
    background-color: #ef4444;
  }
  
  .immich-status-warning {
    background-color: #f59e0b;
  }
  
  .immich-activity-item {
    transition: background-color 0.2s ease;
  }
  
  .immich-activity-item:hover {
    background-color: rgba(255, 255, 255, 0.05);
  } 