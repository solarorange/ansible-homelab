---
# ErsatzTV Deployment
# Production-ready Ansible tasks for homelab ErsatzTV deployment

- name: Include ErsatzTV deployment tasks
  block:
    - name: Validate ErsatzTV configuration
      ansible.builtin.include_tasks: validate.yml
      tags: [ersatztv, validation]

    - name: Setup ErsatzTV prerequisites
      ansible.builtin.include_tasks: prerequisites.yml
      tags: [ersatztv, setup]

    - name: Deploy ErsatzTV service
      ansible.builtin.include_tasks: deploy.yml
      when: ersatztv_enabled | default(true)
      tags: [ersatztv, deploy]

    - name: Configure ErsatzTV monitoring
      ansible.builtin.include_tasks: monitoring.yml
      when: ersatztv_monitoring_enabled | default(true)
      tags: [ersatztv, monitoring]

    - name: Configure ErsatzTV security
      ansible.builtin.include_tasks: security.yml
      tags: [ersatztv, security]

    - name: Configure ErsatzTV backup
      ansible.builtin.include_tasks: backup.yml
      when: ersatztv_backup_enabled | default(true)
      tags: [ersatztv, backup]

    - name: Configure ErsatzTV homepage integration
      ansible.builtin.include_tasks: homepage.yml
      when: ersatztv_homepage_enabled | default(true)
      tags: [ersatztv, homepage]

    - name: Configure ErsatzTV alerts
      ansible.builtin.include_tasks: alerts.yml
      when: ersatztv_alerting_enabled | default(true)
      tags: [ersatztv, alerts]

    - name: Validate ErsatzTV deployment
      ansible.builtin.include_tasks: validate_deployment.yml
      tags: [ersatztv, validation]

  when: ersatztv_enabled | default(true)
  tags: [ersatztv, always] 