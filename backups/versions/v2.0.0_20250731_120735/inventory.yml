---
# Homelab Inventory Configuration
# Production-ready inventory for homelab deployment

all:
  children:
    homelab_core:
      hosts:
        core1:
          ansible_host: "{{ lookup('env', 'HOMELAB_IP_1') | default('{{ ansible_default_ipv4.address }}') }}"
          ansible_user: "{{ lookup('env', 'HOMELAB_USERNAME') | default('homelab') }}"
        core2:
          ansible_host: "{{ lookup('env', 'HOMELAB_IP_2') | default('{{ ansible_default_ipv4.address }}') }}"
          ansible_user: "{{ lookup('env', 'HOMELAB_USERNAME') | default('homelab') }}"
        core3:
          ansible_host: "{{ lookup('env', 'HOMELAB_IP_3') | default('{{ ansible_default_ipv4.address }}') }}"
          ansible_user: "{{ lookup('env', 'HOMELAB_USERNAME') | default('homelab') }}"
        core4:
          ansible_host: "{{ lookup('env', 'HOMELAB_IP_4') | default('{{ ansible_default_ipv4.address }}') }}"
          ansible_user: "{{ lookup('env', 'HOMELAB_USERNAME') | default('homelab') }}"
      vars:
        ansible_ssh_common_args: '-o StrictHostKeyChecking=no'
        ansible_python_interpreter: /usr/bin/python3
        ansible_ssh_private_key_file: "{{ lookup('env', 'SSH_PRIVATE_KEY_FILE') | default('~/.ssh/homelab_key') }}"
        ansible_ssh_pipelining: true
        ansible_ssh_retries: 3
        ansible_become: true
        ansible_become_method: sudo
        ansible_become_user: root
        ansible_gather_timeout: 30
        ansible_timeout: 300

    ansible_control:
      hosts:
        ansible:
          ansible_host: "{{ lookup('env', 'ANSIBLE_SERVER_IP') | default('{{ ansible_default_ipv4.address }}') }}"
          ansible_user: "{{ lookup('env', 'HOMELAB_USERNAME') | default('homelab') }}"
      vars:
        ansible_connection: local

# Network segmentation configuration
network_segments:
  - name: homelab
    subnet: "{{ lookup('env', 'HOMELAB_SUBNET') | default('{{ ansible_default_ipv4.address }}/24') }}"
    gateway: "{{ lookup('env', 'HOMELAB_GATEWAY') | default('{{ ansible_default_ipv4.address }}') }}"

# Resource limits
resource_limits:
  cpu_shares: "{{ lookup('env', 'CPU_SHARES') | default('1024') | int }}"
  memory_limit: "{{ lookup('env', 'MEMORY_LIMIT') | default('2G') }}"
  memory_swap: "{{ lookup('env', 'MEMORY_SWAP') | default('4G') }}"
  memory_reservation: "{{ lookup('env', 'MEMORY_RESERVATION') | default('1G') }}"
  cpus: "{{ lookup('env', 'CPU_LIMIT') | default('2') | int }}"

# Service configuration
enabled_services:
  # Core Infrastructure
  - traefik
  - authentik
  - portainer

  # Monitoring Stack
  - grafana
  - prometheus
  - influxdb
  - telegraf
  - loki
  - promtail
  - alertmanager
  - blackbox_exporter

  # Media Services
  - sonarr
  - radarr
  - prowlarr
  - bazarr
  - overseerr
  - jellyfin
  - tautulli
  - komga
  - audiobookshelf
  - ersatztv
  - lidarr
  - readarr
  - emby
  - calibre-web

  # File Services
  - nextcloud
  - samba
  - syncthing

  # Development Tools
  - gitlab
  - harbor
  - code_server

  # AI and Development
  - pezzo

  # Storage and files
  - minio
  - paperless
  - bookstack
  - immich
  - filebrowser

  # Automation and smart home
  - homeassistant
  - mosquitto
  - zigbee2mqtt
  - nodered
  - n8n

  # Security services
  - vault
  - crowdsec
  - fail2ban
  - wireguard

  # Network services
  - pihole
  - nginx_proxy_manager

  # Backup solutions
  - kopia
  - duplicati

  # Utilities
  - watchtower
  - dashdot
  - guacamole
  - heimdall
  - homarr
  - requestrr
  - unmanic
  - vaultwarden
  - linkwarden
  - reconya
  - dumbassets
  - romm
  - fing

# Feature toggles
monitoring_enabled: "{{ lookup('env', 'MONITORING_ENABLED') | default('true') | bool }}"
media_enabled: "{{ lookup('env', 'MEDIA_ENABLED') | default('true') | bool }}"
security_enhanced: "{{ lookup('env', 'SECURITY_ENHANCED') | default('true') | bool }}"
automation_enabled: "{{ lookup('env', 'AUTOMATION_ENABLED') | default('true') | bool }}"
