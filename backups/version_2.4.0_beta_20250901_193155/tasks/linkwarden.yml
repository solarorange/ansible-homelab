---
# Linkwarden Deployment Task
# Deploys Linkwarden bookmark management service

- name: Deploy Linkwarden
  ansible.builtin.include_role:
    name: linkwarden
  tags: [linkwarden, deploy]
  register: linkwarden_deployment_result

- name: Display Linkwarden deployment summary
  ansible.builtin.debug:
    msg: |
      ========================================
      LINKWARDEN DEPLOYMENT SUMMARY
      ========================================

      Service: Linkwarden Bookmark Manager
      Status: {{ 'SUCCESS' if linkwarden_deployment_result is success else 'FAILED' }}
      URL: https://{{ linkwarden_subdomain | default('linkwarden') }}.{{ domain }}
      Local URL: http://{{ ansible_default_ipv4.address }}:{{ linkwarden_port | default(3000) }}

      Features:
      - Bookmark management and organization
      - Collections and tags support
      - Link previews and metadata
      - User authentication
      - API integration
      - Import/export functionality

      Integration:
      - Traefik: {{ 'Enabled' if linkwarden_traefik_enabled | default(true) else 'Disabled' }}
      - Authentik: {{ 'Enabled' if linkwarden_auth_method == 'authentik' else 'Disabled' }}
      - Monitoring: {{ 'Enabled' if linkwarden_monitoring_enabled | default(true) else 'Disabled' }}
      - Backup: {{ 'Enabled' if linkwarden_backup_enabled | default(true) else 'Disabled' }}
      - Homepage: {{ 'Enabled' if linkwarden_homepage_enabled | default(true) else 'Disabled' }}

      ========================================
  when: linkwarden_deployment_result is defined
  tags: [linkwarden, summary]
