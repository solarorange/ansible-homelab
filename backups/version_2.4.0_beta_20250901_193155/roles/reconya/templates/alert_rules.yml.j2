---
# Reconya Alert Rules Configuration
# Generated by Ansible - Do not edit manually

groups:
  - name: reconya
    rules:
      - alert: ReconyaServiceDown
        expr: up{job="reconya"} == 0
        for: 1m
        labels:
          severity: critical
          service: reconya
        annotations:
          summary: "Reconya service is down"
          description: "Reconya service has been down for more than 1 minute"

      - alert: ReconyaHighResponseTime
        expr: http_request_duration_seconds{job="reconya"} > 5
        for: 2m
        labels:
          severity: warning
          service: reconya
        annotations:
          summary: "Reconya high response time"
          description: "Reconya service response time is above 5 seconds"

      - alert: ReconyaHighErrorRate
        expr: rate(http_requests_total{job="reconya",status=~"5.."}[5m]) > 0.1
        for: 2m
        labels:
          severity: warning
          service: reconya
        annotations:
          summary: "Reconya high error rate"
          description: "Reconya service has high error rate (>10% in 5m)"

      - alert: ReconyaDatabaseError
        expr: reconya_database_errors_total{job="reconya"} > 0
        for: 1m
        labels:
          severity: critical
          service: reconya
        annotations:
          summary: "Reconya database errors"
          description: "Reconya service is experiencing database errors"

      - alert: ReconyaNetworkScanFailure
        expr: reconya_network_scan_failures_total{job="reconya"} > 0
        for: 5m
        labels:
          severity: warning
          service: reconya
        annotations:
          summary: "Reconya network scan failures"
          description: "Reconya network scanning is experiencing failures" 