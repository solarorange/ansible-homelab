# ErsatzTV Backup Configuration
# Generated by Ansible - Do not edit manually

# Backup Settings
backup:
  enabled: {{ ersatztv_backup_enabled | lower }}
  schedule: "{{ ersatztv_backup_schedule | default('0 2 * * *') }}"
  retention: {{ ersatztv_backup_retention | default(7) }}
  compression: {{ ersatztv_backup_compression | default('gzip') }}
  encryption: {{ ersatztv_backup_encryption | default(false) }}

# Backup Sources
sources:
  - name: "config"
    path: "{{ ersatztv_config_dir }}"
    exclude:
      - "*.tmp"
      - "*.log"
      - "cache"
      - "transcode"
      - "backup"
  - name: "data"
    path: "{{ ersatztv_data_dir }}"
    exclude:
      - "*.tmp"
      - "*.log"
      - "cache"
      - "transcode"
  - name: "logs"
    path: "{{ ersatztv_logs_dir }}"
    exclude:
      - "*.tmp"
      - "backup"

# Backup Destinations
destinations:
  local:
    enabled: {{ ersatztv_backup_local_enabled | lower }}
    path: "{{ ersatztv_backup_dir }}"
    max_size: "{{ ersatztv_backup_local_max_size | default('10GB') }}"
  remote:
    enabled: {{ ersatztv_backup_remote_enabled | lower }}
    type: "{{ ersatztv_backup_remote_type | default('s3') }}"
    endpoint: "{{ ersatztv_backup_remote_endpoint | default('') }}"
    bucket: "{{ ersatztv_backup_remote_bucket | default('') }}"
    access_key: "{{ ersatztv_backup_remote_access_key | default('') }}"
    secret_key: "{{ ersatztv_backup_remote_secret_key | default('') }}"
    region: "{{ ersatztv_backup_remote_region | default('us-east-1') }}"

# Backup Verification
verification:
  enabled: {{ ersatztv_backup_verification_enabled | lower }}
  checksum: {{ ersatztv_backup_checksum | default('sha256') }}
  integrity_check: {{ ersatztv_backup_integrity_check | default(true) }}

# Backup Notifications
notifications:
  enabled: {{ ersatztv_backup_notifications_enabled | lower }}
  email:
    enabled: {{ ersatztv_backup_email_enabled | lower }}
    to: "{{ ersatztv_backup_email_to | default('') }}"
    from: "{{ ersatztv_backup_email_from | default('ersatztv@{{ domain }}') }}"
    smtp_server: "{{ ersatztv_backup_smtp_server | default('{{ ansible_default_ipv4.address }}') }}"
    smtp_port: "{{ ersatztv_backup_smtp_port | default(587) }}"
    smtp_username: "{{ ersatztv_backup_smtp_username | default('') }}"
    smtp_password: "{{ ersatztv_backup_smtp_password | default('') }}"
  slack:
    enabled: {{ ersatztv_backup_slack_enabled | lower }}
    webhook_url: "{{ ersatztv_backup_slack_webhook | default('') }}"
    channel: "{{ ersatztv_backup_slack_channel | default('#backups') }}"
  discord:
    enabled: {{ ersatztv_backup_discord_enabled | lower }}
    webhook_url: "{{ ersatztv_backup_discord_webhook | default('') }}"

# Backup Pre/Post Scripts
scripts:
  pre_backup:
    enabled: {{ ersatztv_backup_pre_script_enabled | lower }}
    script: "{{ ersatztv_backup_pre_script | default('') }}"
  post_backup:
    enabled: {{ ersatztv_backup_post_script_enabled | lower }}
    script: "{{ ersatztv_backup_post_script | default('') }}"

# Backup Cleanup
cleanup:
  enabled: {{ ersatztv_backup_cleanup_enabled | lower }}
  schedule: "{{ ersatztv_backup_cleanup_schedule | default('0 3 * * *') }}"
  keep_days: {{ ersatztv_backup_keep_days | default(30) }}
  keep_versions: {{ ersatztv_backup_keep_versions | default(10) }}

# Database Backup
database:
  enabled: {{ ersatztv_database_backup_enabled | lower }}
  type: "{{ ersatztv_database_type | default('sqlite') }}"
  path: "{{ ersatztv_database_path | default('/config/ersatztv.db') }}"
  backup_path: "{{ ersatztv_database_backup_path | default('/backup/database') }}"

# Media Backup
media:
  enabled: {{ ersatztv_media_backup_enabled | lower }}
  paths: "{{ ersatztv_media_backup_paths | default([]) }}"
  exclude_patterns:
    - "*.tmp"
    - "*.log"
    - "Thumbs.db"
    - ".DS_Store" 