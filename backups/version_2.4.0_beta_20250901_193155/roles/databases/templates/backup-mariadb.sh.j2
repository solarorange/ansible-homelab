#!/bin/bash
# MariaDB Backup Script
BACKUP_DIR="{{ docker_dir }}/mariadb/backup"
TIMESTAMP=$(date +%Y%m%d_%H%M%S)
BACKUP_FILE="$BACKUP_DIR/mariadb_backup_$TIMESTAMP.sql.gz"
mkdir -p "$BACKUP_DIR"
docker exec {{ mariadb_container_name }} mysqldump -u root -p"{{ mariadb_root_password }}" --all-databases | gzip > "$BACKUP_FILE"
find "$BACKUP_DIR" -name "mariadb_backup_*.sql.gz" -mtime +7 -delete
echo "Backup created: $BACKUP_FILE" 