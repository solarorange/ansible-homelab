# Pezzo Fail2ban Configuration
# Intrusion prevention for Pezzo services

[DEFAULT]
# Ban hosts for 1 hour
bantime = 3600
# Check for repeated failures for 10 minutes
findtime = 600
# Allow 5 failures before banning
maxretry = 5
# Ban on all interfaces
banaction = iptables-allports
# Use systemd journal
backend = systemd

# Pezzo Server jail
[pezzo-server]
enabled = true
port = http,https
filter = pezzo-server
logpath = /var/log/pezzo/server/access.log
maxretry = 5
findtime = 600
bantime = 3600

# Pezzo Console jail
[pezzo-console]
enabled = true
port = http,https
filter = pezzo-console
logpath = /var/log/pezzo/console/access.log
maxretry = 5
findtime = 600
bantime = 3600

# Pezzo API jail
[pezzo-api]
enabled = true
port = http,https
filter = pezzo-api
logpath = /var/log/pezzo/server/api.log
maxretry = 3
findtime = 300
bantime = 7200

# Pezzo Authentication jail
[pezzo-auth]
enabled = true
port = http,https
filter = pezzo-auth
logpath = /var/log/pezzo/server/auth.log
maxretry = 3
findtime = 300
bantime = 7200

# Pezzo Database jail
[pezzo-database]
enabled = true
port = 5432
filter = pezzo-database
logpath = /var/log/pezzo/postgres/postgresql.log
maxretry = 3
findtime = 300
bantime = 7200

# Pezzo Redis jail
[pezzo-redis]
enabled = true
port = 6379
filter = pezzo-redis
logpath = /var/log/pezzo/redis/redis.log
maxretry = 3
findtime = 300
bantime = 7200 